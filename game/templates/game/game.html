{% extends 'game/base.html' %}

{% block extra_js %}
    <script type="text/javascript" src="/static/js/bootstrap-button.js"></script> <!-- remove -->
    <script type="text/javascript" src="/static/js/game.js"></script>
    <script type="text/javascript" src="/static/js/paper.js"></script>
    <script type="text/javascript" src="/static/js/entity.js"></script>
<script type = "text/javascript">
paper.install(window);
$(function() {
    paper.setup('canvas');

    $('#canvas').css('height', '600px');
    paper.view.viewSize = [700, 600];

    entitySetup();

    //var snail = new SnailGroup(5);
    //var snailmoo = new SnailGroup(5);

    //var snailmoo = new SnailGroup(5, outsideRight);
    var snailmoo = new Ghost('blue', floor3Room3);

    var scaleCount = 0; 
    var weight = 1;

    view.onFrame = function(event) {
        snailUpdate();
        //snail.move();
        snailmoo.move();
    }

    var click = true;
    tool.onMouseDown = function(event) {
        if (click) {
            //snailmoo.setDestination(mainRoom.position);
            //snail.setDestination(event.point);
        } else {
            //snailmoo.setDestination(event.point);
        }
        click = !click;
    }
    scroll = function(movement) {
        if (!project.activeLayer.translate(movement).bounds.contains(view.center))
            project.activeLayer.translate(movement.multiply(-1));
    }
    
    tool.onKeyDown = function(event) {
        if (event.key == 'w') {
            snailmoo.moveUp();
        }
        if (event.key == 'a') {
            snailmoo.moveLeft();
        }
        if (event.key == 's') {
            snailmoo.moveDown();
        }
        if (event.key == 'd') {
            snailmoo.moveRight();
        }
        if ((event.key == '=') && (scaleCount < 2)) {
            project.activeLayer.scale(1.25, view.center);
            weight *= 0.9;
            scaleCount++;
        }
        if ((event.key == '-') && (scaleCount > -6)) {
            project.activeLayer.scale(0.8, view.center);
            weight *= 1 / 0.9;
            scaleCount--;
        }
        if (event.key == 'right') {
            scroll(new Point(-100 * weight, 0));
        }
        if (event.key == 'left') {
            scroll(new Point(100 * weight, 0));
        }
        if (event.key == 'up') {
            scroll(new Point(0, 100 * weight));
        }
        if (event.key == 'down') {
            scroll(new Point(0, -100 * weight));
        }
        if (event.key == 'n') {
            snailmoo.pickUp();
        }
        if (event.key == 'm') {
            snailmoo.drop();
        }
        if (event.key == 't') {
            snailmoo.barricadeUp();
        }
        if (event.key == 'f') {
            snailmoo.barricadeLeft();
        }
        if (event.key == 'g') {
            snailmoo.barricadeDown();
        }
        if (event.key == 'h') {
            snailmoo.barricadeRight();
        }
        if (event.key == 'i') {
            snailmoo.breakBarUp();
        }
        if (event.key == 'j') {
            snailmoo.breakBarLeft();
        }
        if (event.key == 'k') {
            snailmoo.breakBarDown();
        }
        if (event.key == 'l') {
            snailmoo.breakBarRight();
        }

    }

});
</script>
{% endblock %}

{% block content %}
<canvas id="canvas" class="grid_9 alpha"></canvas>
<div class="grid_3 alpha">
    <div style="padding: 10px; height: 530px">
        <p>
            <a class="btn btn-success control_btn_left" id="btn_move" href="#">Move</a>
            <a class="btn btn-success control_btn_right" id="btn_barricade" href="#">Barricade</a>
        </p>
        <p>
            <a class="btn btn-success control_btn_left" id="btn_shoot" href="#">Shoot</a>
            <a class="btn btn-success control_btn_right" id="btn_reload" href="#">Reload</a>
        </p>

        <p>&nbsp;</p>
        <p>
            <a class="btn btn-success arrow_btn" id="btn_arrow_up" href="#">
                <i class="icon-arrow-up icon-white"></i>
            </a>
        </p>
        <p>
            <a class="btn btn-success arrow_btn" id="btn_arrow_left" href="#">
                <i class="icon-arrow-left icon-white"></i>
            </a>
            <a class="btn btn-success arrow_btn disabled" id="btn_arrow_go" href="#">
                GO
            </a>
            <a class="btn btn-success arrow_btn" id="btn_arrow_right" href="#">
                <i class="icon-arrow-right icon-white"></i>
            </a>
        </p>
        <p>
            <a class="btn btn-success arrow_btn" id="btn_arrow_down" href="#">
                <i class="icon-arrow-down icon-white"></i>
            </a>
        </p>
    </div>

    <div style="padding: 10px">
        <a class="btn btn-success" href="#" id="btn_show_instructions">
            <i class="icon-info-sign icon-white"></i> Show Instructions
        </a>
    </div>
</div>

<div id="instructions_modal" class="modal hide">
    <div class="modal-header">
        <h3>Game Instructions</h3>
    </div>
    <div class="modal-body">
        <p>
            <span class="control_key">=</span> Zoom In<br>
            <span class="control_key">-</span> Zoom Out<br>

        </p>
    </div>
    <div class="modal-footer">
        <a href="#" class="btn btn-primary btn-success" data-dismiss="modal">Got It!</a>
    </div>
</div>

<img src="/static/img/snail_teeth.png" class="sprite" id="snail" />
<img src="/static/img/houseplan.jpg" class="sprite" id="house" />
<img src="/static/img/ghost_gun.png" class="sprite" id="ghost" />
<img src="/static/img/ghost_ammobox.png" class="sprite" id="ghostbox" />
<img src="/static/img/ammobox.png" class="sprite" id="ammobox" />
<img src="/static/img/barricade_stairs.png" class="sprite" id="stairBarricade" />
<img src="/static/img/barricade_door.png" class="sprite" id="doorBarricade" />
{% endblock %}
